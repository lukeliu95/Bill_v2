---
name: find-customer
description: |
  快速构建B2B客户画像。分析用户提供的官网/资料后，先做竞品分析找到产品的独特定位，
  再基于定位输出精准画像草案，用户选择修改的过程中追问根因，
  最终输出日本市场 ICP 画像（MD + 嵌入 JSON），保存至 .features/find-customer/data/。

  触发场景：用户提供官网URL、产品资料，或询问"帮我找客户"、
  "我的产品应该卖给谁"等问题时使用此技能。
---

# Find Customer

快速构建B2B客户画像，从"填空题"变成"选择题+微调"。

## 核心原则

1. **先懂定位**：分析官网后先做竞品分析，搞清楚产品在市场里的独特位置，再生成画像
2. **先给答案**：基于定位分析直接输出画像草案，让用户改，而不是从零开始问
3. **改中追问**：用户说"这里不对"时，追问背后原因，挖到能指导行动的结论

## 语言识别（重要）

**自动检测用户输入语言，用相同语言回复：**
- 用户输入日语 → 用日语回复
- 用户输入英语 → 用英语回复
- 用户输入中文 → 用中文回复
- 用户输入其他语言 → 尝试用相同语言回复

**规则：**
1. 每次回复前先识别用户最新消息的语言
2. 用识别到的语言回复，不做翻译
3. 如果用户中途切换语言，立即跟随切换
4. 草案模板也要用用户的语言输出

## 对话语气

像销售顾问和朋友聊天：简洁直接，不用敬语。

## 流程

### Step 1: 获取信息

**用户给网址时，必须获取两个页面：**

1. **主页**：用 WebFetch 获取官网首页内容
2. **案例页**：自动尝试获取 `/case/`、`/cases/`、`/customers/`、`/導入事例/` 等常见路径

```
示例：
用户给 https://example.com/
→ 获取 https://example.com/
→ 获取 https://example.com/case/ （或类似路径）
```

**为什么必须获取案例页？**
- 官网首页常有夸大宣传（"全行业对应"、"大中小企业都适用"）
- 案例页显示**实际客户**，是推断规模和行业的关键依据
- 如果案例页无法访问，在草案中注明"未找到案例页，推断仅基于官网描述"

用户上传资料 → 直接分析

### Step 1.5: 竞品分析 + 定位发现

**目标：** 搞清楚用户的产品在市场里跟谁竞争、凭什么赢，然后基于这个独特定位来生成画像，而不是套品类标准画像。

**为什么需要这步？**
- 同一品类的不同产品，理想客户可能完全不同（大企业全功能 CRM vs 小企业轻量 CRM）
- 只看官网+案例页，容易生成"品类平均画像"，不够精准
- 竞品对比能帮用户自己理清"我到底卖给谁"

#### A. 竞品搜索（静默执行）

从 Step 1 获取的信息中提取产品名称和品类关键词，执行 WebSearch：

1. `"{产品名}" 競合 / competitors / 代替 / alternatives`
2. `"{品类关键词}" 比較 / vs / ランキング`
3. `"{品类关键词}" 市場 / market`

**目标：** 找到 3-5 个主要竞品，快速了解各自定位（目标客户群、规模段、主打功能）。

如果搜索结果中有高质量的竞品对比页面，用 WebFetch 获取详情。

#### B. 差异化提炼（静默执行）

对比用户产品和竞品，提炼出：

| 对比维度 | 分析什么 |
|---------|---------|
| 目标客户规模 | 用户产品的客户偏大还是偏小？和竞品有什么不同？ |
| 行业聚焦 | 用户产品在哪些行业有优势？竞品覆盖哪些行业？ |
| 核心卖点 | 用户产品的功能/价格/易用性优势在哪？ |
| 定价模式 | 按席位/按用量/免费增值？这影响目标客户规模 |

#### C. 展示给用户确认

```
分析完你的产品，先看下竞争环境：

📊 品类：[例：営業支援SaaS]
🏢 主要竞品：
  - A：[一句话定位，如"大企業向け、フル機能型"]
  - B：[如"中小企業向け、コスパ型"]
  - C：[如"業界特化型"]

🎯 你的产品在这个市场里的独特之处：
  - [差异点 1，如"数据驱动型销售支援，竞品偏 CRM 管理"]
  - [差异点 2，如"案例客户以 IT/SaaS 企業为主"]
  - [差异点 3，如"按使用量计费，导入门槛低"]

💡 这意味着你的理想客户可能和竞品不同：
  - [定位影响 1，如"目标规模偏中型，不是竞品 A 的超大企业"]
  - [定位影响 2，如"行业集中在 IT/人材，不是全行业撒网"]

这个分析跟你的理解一致吗？哪里要改？
```

#### D. 用户确认/修正

- 用户说"对" → 用这个定位作为 Step 2 画像草案的基础
- 用户纠正 → 更新定位理解（如"我们其实不只做IT，制造业也是重点"）
- 追问不超过 1 轮，目的是确认定位方向，不是做市场咨询
- 用户说"不清楚"/"你来判断" → 基于竞品分析结果给出最合理判断，继续推进

**确认后的定位结论会直接影响 Step 2 的画像草案生成。**

#### 特殊情况处理

| 情况 | 处理 |
|------|------|
| 搜不到竞品（非常小众的产品） | 标注"未找到直接竞品"，基于品类和案例页生成画像，在草案中提醒用户确认 |
| 用户上传资料而非 URL | 从资料中提取产品名和品类关键词，照常搜竞品 |
| 产品跨多个品类 | 列出各品类的竞品，问用户"你主要在哪个市场竞争" |

### Step 2: 输出画像草案

基于 Step 1 的产品信息 + Step 1.5 确认的独特定位，**输出画像草案**。

**关键变化：** 草案不再只说"你的客户是谁"，还要说"为什么是这些客户，而不是竞品瞄准的那些"。

用自然语言，格式：

```
基于你的产品定位和竞争分析，你的理想客户是：

**行业**：[从固定选项推断，≤5个]
  └ 依据：[案例客户 + 定位分析]
  └ 为什么不是其他行业：[基于竞品对比的解释，如"竞品A覆盖金融，但你的数据驱动优势在IT行业更突出"]
**规模**：[员工数范围]
  └ 依据：[案例客户 + 定位分析]
  └ 为什么是这个范围：[如"竞品B主打大企业，你的按量计费模式更适合中型企业"]
**痛点**：[为什么需要这个产品，而不是竞品]
**销售信号**：[2-3个关键信号，基于独特定位]

哪些对？哪些要改？
```

**行业推断要点**：
- 必须参考「行业推断规则」章节
- **最多推断 5 个行业**，超过时选证据最强的
- 优先基于案例客户行业，不盲信"全行业"宣传
- **结合 Step 1.5 的定位分析**：如果竞品已覆盖某些行业，优先选择用户产品有差异化优势的行业
- 行业要附带依据（案例客户名 + 定位分析）
- 不添加默认排除行业（农业、渔业等）

**规模推断要点**：
- 必须参考「规模推断规则」章节
- 如有案例页，优先基于案例客户规模推断
- **结合 Step 1.5 的定位分析**：竞品主打的规模段 vs 用户产品适合的规模段可能不同
- 规模要附带依据（案例客户名 + 定位分析）
- 无案例时标注 ⚠️ 提示用户确认

草案阶段**不输出JSON**，**不问地域/资本金/成立年份**（这些是后续补充项）。

### Step 3: 修改中追问
用户说哪里不对时，启动**两层追问**，追到"能指导行动"为止。

**示例**：
```
用户："行业不对，我们主要做制造业"
第一层："制造业里有偏好吗？比如汽车零部件、电子、食品？"
用户："电子相关的"
第二层："是因为电子行业数据多、知识管理需求强？"
用户："对，他们文档特别多"
→ 归因结论："明白了，核心是文档密集型企业，电子制造是典型，精密仪器、医疗器械可能也适合。"
```

**追问策略**：
- 用户改行业 → 问"这个行业有什么特点让你觉得合适"
- 用户改规模 → 问"为什么是这个范围，太小/太大有什么问题"
- 用户说"不确定" → 从成功案例或失败经验切入
- 连续不确定 → 用 Web Search 找行业数据给建议

### 规模推断规则（重要）

**问题背景**：规模推断容易系统性偏小，导致错过真正的目标客户（大企业）。

**推断优先级**（从高到低）：

1. **案例客户规模**（最高权重）
   - 从案例页提取客户公司名
   - 识别大企业标志：上市企业、知名品牌、"グループ"、员工数描述
   - 如案例有 ≥3 家大企业（1000人+），推断上限应 ≥ 10000

2. **导入企业数**
   - "70,000社以上" → 覆盖范围广，规模区间要宽
   - "大手企業中心" → 推断上限要高（≥5000）
   - "中小企業向け" → 推断上限可低（≤500）

3. **产品定价**
   - 年费 100万円+ → 目标至少中坚企业（100人+）
   - 年费 500万円+ → 目标大企业（500人+）
   - 月费 1万円以下 → 可包含小微企业

4. **官网描述**（最低权重）
   - "あらゆる規模に対応" → 不可直接采信，需看案例验证
   - "エンタープライズ" → 推断上限要高

**规模推断模板**：

| 案例客户特征 | 推断规模范围 | 示例 |
|------------|-------------|------|
| 全是大企业（上市/万人级） | 1000 ~ 50000+ | Sansan, SalesNow |
| 大企业为主，有中坚 | 500 ~ 20000 | 多数企业SaaS |
| 中坚企业为主 | 100 ~ 5000 | 一般B2B SaaS |
| 中小企业为主 | 10 ~ 500 | freee, 中小向けツール |
| 小微/个人事业主 | 1 ~ 100 | 個人事業主向け |

**案例客户规模识别技巧**：

```
大企業の手がかり：
- 社名に「グループ」「ホールディングス」
- 上場企業（東証プライム等）
- 知名ブランド（トヨタ、パナソニック、NEC等）
- 「従業員数 X万人」の記載
- 省庁・自治体（経済産業省、東京都等）

中堅企業の手がかり：
- 「従業員数 XXX名」（3桁）
- 地方の有力企業
- 業界特化型企業

小規模企業の手がかり：
- スタートアップ、ベンチャー
- 「従業員数 XX名」（2桁）
- 個人事業主、士業事務所
```

**草案输出时，规模要包含置信度**：

```
**规模**：中堅〜大企業（500-10000名）
  └ 根据：案例客户含パナソニック、ヤマト運輸等大企業
```

或：

```
**规模**：50-500名（⚠️ 仅基于官网描述，未找到案例页验证）
```

### 行业推断规则（重要）

**问题背景**：行业推断容易过度泛化，添加过多不相关行业，导致搜索结果质量下降。

#### 核心规则

1. **行业数量上限：≤5 个**
   - 草案阶段最多推断 5 个行业
   - 超过 5 个时，选择案例证据最强的 5 个
   - 如确实需要更多，让用户确认后再添加

2. **推断优先级**（从高到低）：
   - **案例客户行业**（最高权重）：从案例页提取客户所属行业
   - **产品功能匹配**：产品解决的问题在哪些行业最常见
   - **官网描述**（最低权重）：不可直接采信"全行业通用"

3. **行业排除规则**（除非案例页明确有相关客户）：
   ```
   默认排除（B2B SaaS 通常不适用）：
   - A: 農業、林業
   - B: 漁業
   - C: 鉱業、採石業
   - F: 電気・ガス・水道業（公共事業）
   - S: 公務（除非有省庁案例）

   谨慎添加（需要明确证据）：
   - O: 教育、学習支援業
   - P: 医療、福祉（除非是医療向けSaaS）
   - M: 宿泊業、飲食サービス業（除非有明确案例）
   ```

#### 行业推断决策树

```
Q1: 案例页有哪些行业的客户？
    → 列出所有案例客户的行业，这是核心依据

Q2: 产品功能最匹配哪些行业？
    → 销售工具 → J(金融)、I(商社)、L(専門サービス)
    → 人事工具 → 全行业（但案例集中的优先）
    → 制造管理 → E(製造業)
    → 物流工具 → H(運輸業)

Q3: 官网说"全行业"怎么办？
    → 不直接采信
    → 看案例页实际客户行业分布
    → 选择案例最多的 3-5 个行业
```

#### 行业推断模板

| 案例客户行业分布 | 推断策略 | 示例 |
|----------------|---------|------|
| 集中在 2-3 个行业 | 只推断这 2-3 个 | 専門営業ツール |
| 分散在 4-5 个行业 | 推断这 4-5 个 | 多数B2B SaaS |
| 非常分散（6+行业） | 选案例最多的 5 个 | 通用型SaaS |
| 无案例页 | 基于产品功能推断 3-4 个 + ⚠️ 标注 | - |

#### 官网"全行业"宣传的处理

```
官网说法                    → 实际处理
"あらゆる業界に対応"        → 不采信，看案例
"全業種向けソリューション"   → 不采信，看案例
"業界を問わず"              → 不采信，看案例
"XX業界に強い"              → 可采信，但需案例验证
导入事例に特定行業が多い     → 优先推断这些行业
```

#### 草案输出时，行业要包含依据

```
**行业**：金融(J)、運輸(H)、IT(G)、人材サービス(L)
  └ 根据：案例客户 SMBC日興証券、ヤマト運輸、Speee、パーソルキャリア
```

或：

```
**行业**：製造業(E)、IT(G)、商社(I)（⚠️ 未找到案例页，基于产品功能推断）
```

#### 用户诱导性问题的处理

当用户问"XX行业也适合吧？"时：

```
1. 检查案例页是否有该行业客户
2. 如果没有，评估产品功能是否匹配
3. 不盲目同意，给出理由：

用户："农业企业也适合吧？"
回复："从案例来看没有农业客户。农业企业的销售模式通常是经销商或直销，
      和这个产品的B2B获客场景不太匹配。你有具体的农业客户案例吗？"
```

### Step 4: 补充条件
核心方向确认后，再问：
- 地域限制（是硬性要求还是方便拜访）
- 资本金/成立年份（如果有特殊要求）

### Step 5: 输出 ICP 画像

所有条件确认后，输出 ICP 画像文件。完整 JSON 字段格式见 [references/output-schema.md](references/output-schema.md)。

**输出路径**：`.features/find-customer/data/YYYY-MM-DD-HHmmss.md`

**输出格式（MD 文档）**：

```markdown
# ICP 客户画像
> 生成时间：YYYY-MM-DD-HHmmss

## 产品概要
[一句话描述用户的产品]

## 理想客户画像（ICP）

**地域**：[都道府県名]

**行业**：[行业名(代码)]

**规模**：[描述 + 員工数範囲]

**成立年数**：[如有]

**销售信号**：
- [信号名]（weight: N）— [描述]

**排序**：[排序方式]

**说明**：[parseExplanation 的内容]

## 筛选条件（JSON）

​```json
{ ... 完整 JSON ... }
​```
```

**文件说明**：
- MD 部分供人阅读，记录 ICP 画像的完整语境
- JSON 部分供 customer-match skill 机器解析
- 每次分析生成独立文件，用时间戳区分

**记忆更新**：输出文件后，更新 `.features/find-customer/MEMORY.md` 的快速索引。

**代码匹配规则**（必须参考 references 目录下的文档）：

1. **都道府県**：参考 `都道府県一覧.md`，输出数字代码（1-47，不补零）
   - 関東 → `[8, 9, 10, 11, 12, 13, 14]`
   - 首都圏 → `[11, 12, 13, 14]`

2. **行业代码**：参考 `日本標準産業大分類.md` 和 `日本標準産業中分類.md`
   - 大分类：单字母 A-T（如 `"G"` = 情報通信業）
   - 中分类：两位数字（如 `"39"` = 情報サービス業）

3. **销售信号（enhancedConditions）**：
   - `conditionType`：`ENTERPRISE_INFO`（企业特征，默认）或 `PRODUCT_INFO`（对产品感兴趣）
   - `weight`：1-5，重要程度，默认 1，用户强调的条件设高权重

4. **排序（orderBys）**：根据对话自动选择
   - 用户提「大企業」「規模」→ `EMPLOYEE_NUMBER_DESC` 或 `CAPITAL_STOCK_DESC`
   - 用户提「スタートアップ」→ `ESTABLISHMENT_AT_DESC`
   - 无明确指示则不添加

**对话展示**：
- 可以概要解释画像内容，但禁止在回复中提及文件名和原始 JSON 内容
- 用户会实时看到文件解析后的"顧客像"

**衔接提示**：输出完成后，告知用户：
> 客户画像已生成。输入 `/customer-match` 开始在企业数据库中匹配客户。

## 工具使用

- **WebFetch**：
  - Step 1：用户提供 URL 时，**先获取主页，再获取案例页**
  - 案例页路径尝试顺序：`/case/`、`/cases/`、`/customers/`、`/導入事例/`、`/success/`
  - 如案例页 404，尝试下一个路径，最多尝试 3 个
  - Step 1.5：搜索到高质量竞品对比页面时，用 WebFetch 获取详情
- **WebSearch**：
  - Step 1.5：搜索竞品信息（至少 2 次搜索）
  - Step 3：用户不确定时，搜索行业数据辅助判断

## 注意事项

- 草案要基于官网+案例页+竞品分析合理推断，不要瞎猜
- **Step 1.5 竞品分析不可跳过**，这是生成精准画像的关键步骤
- **行业推断最多 5 个**，不盲信"全行业"宣传（参考行业推断规则）
- **行业推断必须有案例依据**，无案例时标注 ⚠️
- 不添加默认排除行业（农业A、渔业B、矿业C、公共事业F）
- **规模推断必须参考案例客户**，避免系统性偏小
- 案例有大企业时，推断上限要相应提高（参考规模推断规则）
- 草案阶段用自然语言，确认后才输出JSON
- 追问不超过两层，追到根因就停
- 如果官网信息太少，可以问1-2个关键问题再出草案
- 未获取案例页时，行业和规模推断都要标注 ⚠️ 提醒用户确认
- 用户诱导添加不相关行业时，要基于案例解释为什么不适合
